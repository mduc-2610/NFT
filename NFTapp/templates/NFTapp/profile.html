{% extends 'main.html' %}
{% load static %}
{% load my_custom_tags %}
{% block content %}
<div class="profile">
    <div class="profile__picture">
        <img src="{{user.cover_photo}}" alt="" class="profile__cover-photo">
    </div>
    <div class="container">
        <div class="profile__info">
            <!-- <h1 style="color: #ffffff; font-size: 3.8rem;">{{url_method}}</h1> -->
            <div class="profile__user-avt--wrap">
                <img src="{{user.avatar}}" alt="" class="profile__user-avt">
            </div>
            <div class="profile__follow flex_aic_jcc">
                <div class="profile__follow--wrap flex_fdc_aif">
                    <button type="submit" class="profile__follow-value profile__follower-value">{{user.follower_set.all|length}}</button>
                    <p class="profile__follow-key">Follower</p>
                </div>
                {% if user != request.user %}
                <div class="profile__follow--wrap profile__followee-value flex_fdc_aif">
                    <button class="profile__follow-value">{{user.following_set.all|length}}</button>
                    <p class="profile__follow-key">Follow</p>
                </div>
                {% else %}
                <div class="profile__follow--wrap profile__followee-value user_authenticated flex_fdc_aif">
                    <button class="profile__follow-value">{{user.following_set.all|length}}</button>
                    <p class="profile__follow-key">Follow</p>
                </div>
                {% endif %}
                {% if user == request.user %}
                <div class="profile__follow--wrap profile__followee-value flex_fdc_aif">
                    <button class="profile__follow-value">{{user.property|floatformat:3}} ETH</button>
                    <p class="profile__follow-key profile__property">Property</p>
                </div>  
                {% endif %}
                <div class="profile__follow--wrap profile__followee-value flex_fdc_aif">
                    <button class="profile__follow-value">{{total_earned|floatformat:3}} ETH</button>
                    <p class="profile__follow-key profile__property">Total Earned</p>
                </div>  
            </div>
            <div class="profile__name--wrap flex_aic_jcc">
                <h1 class="profile__name">@{{user.name}}</h1>
                {% if user != request.user %}
                    <form method="POST" action="" class="profile follow-button-form">
                        {% csrf_token %}
                        <input type="hidden" name="action" value="follow">
                        {% if request.user not in user.follower_set.all|filter_queryset:"follower" %}     
                           <button type="submit" class="follow-button flex_aic_jcc">
                                <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8" fill="none">
                                    <path d="M3.2549 0V3.33333H0V4.64762H3.2549V8H4.72549V4.64762H8V3.33333H4.72549V0H3.2549Z" fill="#000"/>
                                </svg>
                                Follow
                            </button>
                        {% else %}
                            <button type="submit" class="unfollow-button flex_aic_jcc">
                                <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="#000"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"/></svg>
                                Unfollow
                            </button>
                        {% endif %}
                    </form>
                {% endif %}
            </div>
            <p class="profile__joined-day">{{user.date_joined|date:"M d, Y"}}</p>
            <p class="profile__bio">{{user.bio}}</p>
            <button class="see__more">See more</button>
            
        </div>
        <!-- <ul class="profile__activity">
            <li class="profile__activity-item">
                <form action="" method="POST" class="profile__activity-form">
                    <button type="submit" class="profile__activity-button">Collected</button>
                </form>
            </li>
            <li class="profile__activity-item">
                <form action="" method="POST" class="profile__activity-form">
                    <button type="submit" class="profile__activity-button">Created</button>
                </form>
            </li>
            <li class="profile__activity-item">
                <form action="" method="POST" class="profile__activity-form">
                    <button type="submit" class="profile__activity-button">Favorited</button>
                </form>
            </li>
        </ul> -->
        <ul class="profile__activity">
            <li class="profile__activity-item">
                <a href="?filter=collected&">Collected ({{products_collected_len}})</a>
            </li>
            <li class="profile__activity-item">
                <a href="?filter=created&">Created ({{products_created_len}})</a>
            </li>
            <li class="profile__activity-item">
                <a href="?filter=favorited&">Favorite ({{products_favorited_len}})</a>
            </li>
        </ul>
        <div class="profile__filter">
            <form action="" method="POST" class="profile__search-bar">
                {% csrf_token %}
                <input type="hidden" name="action" value="search_product">
                <i class="fa fa-search"></i>
                <input type="text" class="profile__search-text" name="profile-search" placeholder="Search by name" name="search_query">
            </form>
            {% include 'NFTapp/explore/classify/profile_classify.html' %}
        </div>
        <div class="profile__collection" data-num-product="{{products|length}}">
            {% if products|length == 0 %}
                <div class="profile__annouce flex_aic_jcc">
                    <p class="profile__annouce-text">No items to display</p>
                </div>
            {% else %}
                <ul class="profile-product__list" data-num-product="{{products|length}}" data-user="{{request.user}}" data-user-id="{{request.user.id}}" data-user-name="{{request.user.name}}">
                    {% for product in products %}
                        <li data-product-id="{{product.id}}" class="{{product.name}} profile-product__item">
                            <a href="{% url 'collection1' product.id %}" class="profile-product__link">
                                <div>
                                    <img src="{{product.image}}" alt="" class="profile-product__img">
                                </div>
                                <div class="profile-product__info">
                                    <h2 class="profile-product__name limit-line">{{product.name}}</h2>
                                    <p class="profile-product__topic limit-line">{{product.topic.name}}</p>
                                </div>
                                {% if product not in request.user.owners.all and product.author != request.user %}
                                <form method="POST" action="" data-user="{{request.user}}" data-user-id="{{request.user.id}}" data-user-name="{{request.user.name}}" class="cart-add-feature-form">
                                    {% csrf_token %}
                                    <div class="buy-button">Buy now</div>
                                    <button type="submit" class="cart-add-feature flex_aic_jcc">
                                        {% if product in request.user.user_cart.products.all %}
                                        <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                        </svg>
                                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 640 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M5.1 9.2C13.3-1.2 28.4-3.1 38.8 5.1l592 464c10.4 8.2 12.3 23.3 4.1 33.7s-23.3 12.3-33.7 4.1L9.2 42.9C-1.2 34.7-3.1 19.6 5.1 9.2z"/></svg>
                                        {% else %} 
                                        <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                        </svg>
                                        {% endif %}
                                    </button> 
                                </form>
                                {% else %}
                                <div class="profile__announce flex_aic_jcc">
                                    <p class="profile__announce-text">Owned</p>
                                </div>
                                {% endif %}
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <a href="{% url 'profile' user.id %}" class="user-id" style="display: none;"></a>
    </div>
</div>

<div class="profile-user-follower" style="display: none;">
    {% include 'NFTapp/user_behavior.html' with user_behavior_list=profile_user_follower filter="follower" behavior_of_user="Follower" behavior_of_user_for_ajax="follower"%}
</div>

<div class="profile-user-followee" style="display: none;">
    {% include 'NFTapp/user_behavior.html' with user_behavior_list=profile_user_followee filter="followee" behavior_of_user="Follow" behavior_of_user_for_ajax="followee"%}
</div>

{% endblock content %}

{% block scripts %}
<script>
    var check = true;
    const links = document.querySelectorAll('.profile__activity-item a');
    if(window.location.href == document.querySelector(".user-id")) {
        links[0].style.backgroundColor = '#17E3A6';
        links[0].style.color = '#000';
        check = false;
    }

    let prevLink = localStorage.getItem('prevClickedLink');
    if (prevLink !== null && check) {
        prevLink = document.querySelector(`.profile__activity-item a[href="${prevLink}"]`);
        if (prevLink) {
            prevLink.style.backgroundColor = '#17E3A6';
            prevLink.style.color = '#000';
        }
    }

    links.forEach(link => {
        link.addEventListener('click', function(event) {
            localStorage.setItem('prevClickedLink', link.getAttribute('href'));
      });
    });


    const profileFollowerNumber = document.querySelectorAll(".profile__follow-value")[0];
    const profileFolloweeNumber = document.querySelectorAll(".profile__follow-value")[1];

    const profileFollower = document.querySelectorAll('.profile__follow-key')[0];
    const profileFollowee = document.querySelectorAll('.profile__follow-key')[1];
    
    const profileUserFollower = document.querySelector('.profile-user-follower');
    profileFollowerNumber.onclick = (e) => {
        profileUserFollower.style.display = 'block';
    }

    profileFollower.onclick = (e) => {
        profileUserFollower.style.display = 'block';
    }

    const profileUserFollowee = document.querySelector('.profile-user-followee');
    profileFolloweeNumber.onclick = (e) => {
        profileUserFollowee.style.display = 'block';
    }

    profileFollowee.onclick = (e) => {
        profileUserFollowee.style.display = 'block';
    }
    
    const productUserBehavior = document.querySelectorAll('.container-user-behavior');
    productUserBehavior.forEach(element => {
    const userBehaviorBlock = element.querySelector(".user-behavior");
    const userBehaviorCloseButton = element.querySelector(".user-behavior__close");
    userBehaviorCloseButton.onclick = (e) => {
        element.parentNode.style.display = "none";
    }
    
    element.onclick =  (e) => {
        if (e.target !== userBehaviorBlock) {
            element.parentNode.style.display = "none";
        }
    };

    userBehaviorBlock.onclick = (e) => {
        e.stopPropagation();
    }
    
})
    function convertDateTimeString(inputDateString) {
        const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];

        const date = new Date(inputDateString);
        const month = months[date.getMonth()];
        const day = date.getDate();
        const year = date.getFullYear();

        return `${month} ${day.toString().padStart(2, '0')}, ${year}`;
    }

    let collectionList = []
    var collection = $('.profile__collection').html();

    function purchaseCartProduct() {
        $('.cart-purchase.purchase__decision-form').on('submit', function(e) {
            console.log($('.container-cart'));
            e.preventDefault();
            $.ajax({
                type: 'POST',
                url: window.location.href,
                data: {
                    'action': 'purchase_cart_product',
                    'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
                },
                success: function(response) {
                    let numberProducts = $('.cart-add__number-pro').attr('data-number-products');
                    $('.cart-purchase.container-purchase').css('display', 'none');
                    $('.container-cart').css('display', 'none');
                    $('.cart-add-block .cart-add__number-pro').remove();
                    if(response.state == 'can_buy') {
                        let cartProductsBuyed = JSON.parse(response.cart_products_buyed);
                        let thisProductId = $('product-detail-web').attr('data-product-id');
                        let check = false;
                        for(let product of cartProductsBuyed) {
                            console.log(product);
                            let productField = product.fields;
                            if(thisProductId == product.pk) {
                                check = true;
                            }
                            $(`.${productField.name}.profile-product__item`).find('form').remove();
                            $(`.${productField.name}.profile-product__item`).find('a').append(`
                                <div class="profile__announce flex_aic_jcc">
                                    <p class="profile__announce-text">Owned</p>
                                </div>
                            `);
                        }

                        $('.cart-product__list').html(`
                            <div class="cart__hint flex_aic_jcc">
                                <div class="cart-hint__inner flex_fdc_aic">
                                    <p class="cart-hint__announce">Add items to get started</p>
                                    <a href="{% url 'artworks1' %}" class="button cart-hint__redirect">Explore now</a>
                                </div>
                            </div>
                        `)
                        $('.cart__amount').html('');
                        $('.cart__footer').html('');
                        $('.profile-product__item').each((index, element) => {
                            if(element.querySelector('.cart-add-feature')) {
                                element.querySelector('.cart-add-feature').innerHTML = `
                                    <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                    </svg>
                                `
                            }
                        })
                        $('.flash-message-wrap').prepend(`
                            <div class="flash-message flash-message-add flex_aic_jcc">
                                <div class="flash-message__icon flex_aic_jcc">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="#fff"><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"/></svg>
                                </div>
                                <p class="flash-message__text">Buy successfully</p>
                            </div>
                        `);     
                        $('.flash-message-add:first-child').delay(2000).slideUp(300);
                        if($('.product-detail__offer') && check) {
                            $('.product-detail__offer').each((index, element) => {
                                $(element).html(`
                                    <p class="product-detail__announce">You have owned this product</p>
                                `);
                            });
                        }

                    }
                    else {
                        $('.flash-message-wrap').prepend(`
                            <div class="flash-message flash-message-add flash-message-comment flex_aic_jcc">
                                <div class="flash-message__icon flex_aic_jcc">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"/></svg>                                    </div>
                                <p class="flash-message__text">You don't have enough money for this</p>
                            </div>
                        `);                                 
                        $('.flash-message-comment').delay(2000).slideUp(300);
                        $('.cart-add').append(`
                            <span class="cart-add__number-pro flex_aic_jcc" data-number-products="${numberProducts}">${numberProducts}</span>
                        `)
                    }
                }, 
                error: function(jqXHR, textStatus, errorThrown) {
                    console.log(errorThrown);
                }
            })
        })
    }

    $(document).ready(function() {
        function addCartFeature(num_products) {
            const profileProductList = $('.profile-product__list');
            const requestUserData = profileProductList.attr('data-user');
            const requestUserDataId = profileProductList.attr('data-user-id');
            const requestUserDataName = profileProductList.attr('data-user-name'); 
        
            $('.profile-product__item').each(function() {
                var element = this;
                var productId = $(element).attr('data-product-id');
    
                var cartAddFeatureForm = $(element).find('.cart-add-feature-form');
    
                $(cartAddFeatureForm).on("submit", function(e) {
                    e.preventDefault();
                    $.ajax({
                        type: "POST",
                        // url: ,
                        data: {
                            'action': 'cart_add',
                            'product_id': productId,
                            'csrfmiddlewaretoken': $(element).find('input[name=csrfmiddlewaretoken]').val(),
                        },
                        success: function(response) {

                            var product = JSON.parse(response.product);
                            
                            var productData = product[0];
                            var productAuthorData = product[1];
                            var productTopicData = product[2];
    
                            var productDataId = productData.pk;
                            var productDataField = productData.fields;
    
                            var productAuthorDataId = productAuthorData.pk;
                            var productAuthorDataField = productAuthorData.fields;
    
                            var productTopicDataField = productTopicData.fields;
    
                            var itemAmount = `${response.number_cart_products} ${response.number_cart_products == 1 ? 'item' : 'items'}`;
                            var totalPrice = response.total_price;
                            var totalPriceETH = `${parseFloat(response.total_price).toFixed(3)} ETH`;
                            var totalPriceDollar = `$${parseFloat(response.total_price * 1789).toFixed(2)}`;
                            var newCartProductList = [];
                            if (response.state == 'cart_add') {
                                let newCartProduct =  `
                                    <li data-product-id="${productDataId}" class="${productDataField.name} cart-product__item flex_aic_jcsb">
                                        <div class="cart__product--wrap flex_aic_jcsb">
                                            <a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/collection1/" +productDataId}" class="cart-product__img--wrap">
                                                <img src="${productDataField.image}" alt="" class="cart-product__img">
                                            </a>
                                            <div class="cart-product__info">
                                                <p class=" cart-product__name"><a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/collection1/" +productDataId}" class="cart-text">${productDataField.name}</a></p>
                                                <p class="cart-text-2 cart-product__topic">${productTopicDataField.name}</p>
                                                <p class="cart-text-2 cart-product__price">${parseFloat(productDataField.price).toFixed(3)} ETH</p>
                                                <button class="cart-product__detail">Show Details</button>
                                                <div class="container-cart-detail">
                                                    <div class="cart-detail">
                                                        <div class="cart-detail__head flex_aic_jcsb">
                                                            <p class="cart-text cart-detail__heading">This is an unreviewed collection</p>
                                                            <button class="cart-detail__close close-button">
                                                                <svg xmlns="http:www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https:fontawesome.com License - https:fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"/></svg>
                                                            </button>
                                                        </div>
                                                        <div class="cart-detail__info">
                                                            <div class="cart-detail__table--wrap">
                                                                <table class="cart-detail__table">
                                                                    <tr>
                                                                        <td class="cart-text-2">Collection name</td>
                                                                        <td class=""><a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/collection1/" + productDataId}" class="cart-text-2">${productDataField.name}</a></td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="cart-text-2">Creator</td>
                                                                        <td class="cart-text-2">
                                                                            <a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/profile/" + requestUserDataId}" class="cart-detail__author">${productAuthorDataField.name}</a>
                                                                            <p class="">Joined in ${convertDateTimeString(productAuthorDataField.date_joined)}</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="cart-text-2">Total sales</td>
                                                                        <td class="cart-text-2">0 ETH</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="cart-text-2">Total volume</td>
                                                                        <td class="cart-text-2">
                                                                            <p class="">0 ETH</p>
                                                                            <p class="">$0</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="cart-text-2">Total items</td>
                                                                        <td class="cart-text-2">${productDataField.quantity}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="cart-text-2">Created Date</td>
                                                                        <td class="cart-text-2">${convertDateTimeString(productDataField.created_at)}</td>
                                                                    </tr>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <form action="" class="{{product.name}} cart-product__delete-form">
                                            {% csrf_token %}
                                            <input type="hidden" name="action" value="delete_cart_product">
                                            <button class="cart-product__delete">
                                                <svg xmlns="http:www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https:fontawesome.com License - https:fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M164.2 39.5L148.9 64H299.1L283.8 39.5c-2.9-4.7-8.1-7.5-13.6-7.5H177.7c-5.5 0-10.6 2.8-13.6 7.5zM311 22.6L336.9 64H384h32 16c8.8 0 16 7.2 16 16s-7.2 16-16 16H416V432c0 44.2-35.8 80-80 80H112c-44.2 0-80-35.8-80-80V96H16C7.2 96 0 88.8 0 80s7.2-16 16-16H32 64h47.1L137 22.6C145.8 8.5 161.2 0 177.7 0h92.5c16.6 0 31.9 8.5 40.7 22.6zM64 96V432c0 26.5 21.5 48 48 48H336c26.5 0 48-21.5 48-48V96H64zm80 80V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V176c0-8.8 7.2-16 16-16s16 7.2 16 16zm96 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V176c0-8.8 7.2-16 16-16s16 7.2 16 16zm96 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V176c0-8.8 7.2-16 16-16s16 7.2 16 16z"/></svg>
                                            </button>
                                        </form>
                                    </li>
                                `
                                $('.cart-add-block .flash-message-wrap').prepend(`
                                    <div class="flash-message flash-message-add flex_aic_jcc">
                                        <div class="flash-message__icon flex_aic_jcc">
                                            <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"/></svg>
                                        </div>
                                        <p class="flash-message__text">Added to cart</p>
                                    </div>
                                `);
                                
                                $('.flash-message-add').click(function(e) {
                                    $('.container-cart').css('display', 'block');   
                                })
                                
                                $('.flash-message-add:first-child').delay(2000).slideUp(300);
                                
                                $(element).find('.cart-add-feature').html(`
                                    <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                    </svg>
                                    <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 640 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M5.1 9.2C13.3-1.2 28.4-3.1 38.8 5.1l592 464c10.4 8.2 12.3 23.3 4.1 33.7s-23.3 12.3-33.7 4.1L9.2 42.9C-1.2 34.7-3.1 19.6 5.1 9.2z"/></svg>
                                `);

                                collectionList.push([
                                    `.${productDataField.name}.profile-product__item .cart-add-feature`,
                                    `<svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                        </svg>
                                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 640 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M5.1 9.2C13.3-1.2 28.4-3.1 38.8 5.1l592 464c10.4 8.2 12.3 23.3 4.1 33.7s-23.3 12.3-33.7 4.1L9.2 42.9C-1.2 34.7-3.1 19.6 5.1 9.2z"/></svg>`
                                    ]);
                                
                                if(response.number_cart_products == 1) {
                                    $(`.cart-product__list`).html(newCartProduct);
                                    $('.cart__amount').html(`
                                        <p class="cart-text cart__number">${itemAmount}</p>
                                        <form method="POST" action="" class="cart__clear-form">
                                            {% csrf_token %}
                                            <input type="hidden" name="action" value="clear_cart_product">
                                            <button type="submit" class="cart-text cart__clear">Clear all</button>
                                        </form>
                                    `);
    
                                    $('.cart__hint').html('');
                                    $('.cart__footer').html(`
                                        <div class="cart__price flex_aic_jcsb">
                                            <p class="cart-text cart__price-key">Total price</p>
                                            <div class="cart__price-value">
                                                <p class="cart-text cart__price-value-eth">${totalPriceETH}</p>
                                                <p class="cart-text-2 cart__price-value-dollar">${totalPriceDollar}</p>
                                            </div>
                                        </div>
                                        <button type="submit" class="cart__buy-button">Complete purchase</button>

                                        <div class="cart-purchase container-purchase flex_aic_jcc">
                                            <div class="purchase">
                                                <div class="purchase__head flex_aic_jcsb">
                                                    <p class="purchase__text purchase__heading">Are you sure to purchase this product ?</p>
                                                    <button class="purchase__close close-button">
                                                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"/></svg>
                                                    </button>
                                                </div>
                                                <div class="purchase__decision">
                                                    <form method="POST" action="" class="cart-purchase purchase__decision-form flex_aic_jcsb">
                                                        {% csrf_token %}
                                                        <button type="submit" class="purchase__text purchase__agree">Yes</button>
                                                        <button class="purchase__text purchase__disagree">No</button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    `); 
                                    
                                    const $cartContainerPurchase = $('.cart-purchase.container-purchase');
                                    
                                    const $cartBuyButton = $('.cart__buy-button');
                                    console.log($($cartBuyButton));
                                    if($cartBuyButton && $cartContainerPurchase) {
                                        $cartBuyButton.click((e) => {
                                            e.preventDefault();
                                            $cartContainerPurchase.css('display', 'flex');
                                        })
                                    }
                                    
                                    if($cartContainerPurchase) {
                                        $('.purchase__close').click((e) => {
                                            $cartContainerPurchase.css('display', 'none');
                                        });
                                
                                        $cartContainerPurchase.click((e) => {
                                            if(e.target !== $('.cart-purchase .purchase')) {
                                                $cartContainerPurchase.css('display', 'none');
                                            }
                                        });
                                        
                                        $('.cart-purchase .purchase').click((e) => {
                                            e.stopPropagation();
                                        });

                                        $('.purchase__disagree').click((e) => {
                                            e.preventDefault();
                                            $cartContainerPurchase.css('display', 'none');
                                        });
                                    }

                                    purchaseCartProduct();
                                    
                                    $('.cart-add').append(`
                                        <span class="cart-add__number-pro flex_aic_jcc">${response.number_cart_products}</span>
                                    `)
                                    
                                } else {
                                    $(`.cart-product__list`).append(newCartProduct);
                                    $('.cart__number').text(`${itemAmount}`);
                                    $('.cart__price-value-eth').text(`${totalPriceETH}`);
                                    $('.cart__price-value-dollar').text(`${totalPriceDollar}`);
                                    $('.cart-add__number-pro').text(`${response.number_cart_products}`);
                                }
                                newCartProductList.push($(`.cart-product__list .cart-product__item:last-child`));
                            } else {
                                collectionList.push([
                                    `.${productDataField.name}.profile-product__item .cart-add-feature`,
                                    `<svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/></svg>`
                                ]);

                                $('.cart-add-block .flash-message-wrap').prepend(`
                                    <div class="flash-message flash-message-remove flex_aic_jcc">
                                        <div class="flash-message__icon flex_aic_jcc">
                                            <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"/></svg>
                                        </div>
                                        <p class="flash-message__text">Removed from cart</p>
                                    </div>
                                `);
    
                                $('.flash-message-remove:first-child').delay(2000).slideUp(300);
    
                                $(element).find('.cart-add-feature').html(`
                                    <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                    </svg>
                                `);
                                if(response.number_cart_products == 0) {
                                    $(`.cart-product__list`).html(`
                                        <div class="cart__hint flex_aic_jcc">
                                            <div class="cart-hint__inner flex_fdc_aic">
                                                <p class="cart-hint__announce">Add items to get started</p>
                                                <a href="{% url 'artworks1' %}" class="button cart-hint__redirect">Explore now</a>
                                            </div>
                                        </div>
                                    `);
                                    $('.cart__amount').html('');
                                    $('.cart__footer').html('');
                                    $('.cart-add-block .cart-add__number-pro').remove();
                                }
                                else {
                                    $('.cart__number').text(`${itemAmount}`);
                                    $(`.cart-product__list`).find(`.${productDataField.name}.cart-product__item`).remove();
                                    $('.cart__price-value-eth').text(`${totalPriceETH}`);
                                    $('.cart__price-value-dollar').text(`${totalPriceDollar}`);
                                    $('.cart-add__number-pro').text(`${response.number_cart_products}`);
                                }
                            }
                            $('.cart__clear-form').on('submit', function(e) {
                                e.preventDefault();
                                $.ajax({
                                    type: 'POST',
                                    url: window.location.href,
                                    data: {
                                        'action': 'clear_cart_product',
                                        'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
                                    },
                                    success: function(response) {
                                        console.log(response['state']);
                                        if(response.state == 'clear_cart_product') {
                                            $('.cart-product__list').html(`
                                                <div class="cart__hint flex_aic_jcc">
                                                    <div class="cart-hint__inner flex_fdc_aic">
                                                        <p class="cart-hint__announce">Add items to get started</p>
                                                        <a href="{% url 'artworks1' %}" class="button cart-hint__redirect">Explore now</a>
                                                    </div>
                                                </div>
                                            `)
                                            $('.cart__amount').html('');
                                            $('.cart__footer').html('');
                                            $('.cart-add-block .cart-add__number-pro').remove();
                                            $('.profile-product__item').each((index, element) => {
                                                if(element.querySelector('.cart-add-feature')) {
                                                    element.querySelector('.cart-add-feature').innerHTML = `
                                                        <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                                        </svg>
                                                    `
                                                }
                                            })
                                        }
                                    },
                                    error: function(jqXHR, textStatus, errorTh) {
                                        console.log(jqXHR, textStatus, errorTh);
                                    }
                                })
                            })
                            newCartProductList.forEach(element => {
                                const $cartClose = $(element).find('.cart__close');
                                const $containerCart = $(element).find('.container-cart');
                                const $cart = $(element).find('.cart');
                                $cartClose.click(function(e) {
                                    $(element).find('.container-cart').css('display', 'none');
                                })
    
                                $containerCart.click(function(e) {
                                    if(e.target !== $cart) {
                                        $(this).css('display', 'none')
                                    }
                                })
    
                                $cart.click(function(e) {
                                    e.stopPropagation();
                                }) 
            
                                const $containerCartDetail = $(element).find('.container-cart-detail');
                                const $cartDetailClose = $containerCartDetail.find('.cart-detail__close');
                                const $cartDetail = $containerCartDetail.find('.cart-detail');
                                
                                $cartDetailClose.click(function (e) {
                                    $containerCartDetail.css('display', 'none');
                                });
                            
                                $containerCartDetail.click(function (e) {
                                    if(e.target !== $cartDetail) {
                                        $containerCartDetail.css('display', 'none');
                                    }
                                })
                                
                                $cartDetail.click(function(e) {
                                    e.stopPropagation();
                                })
                        
                                const $cartProductDetail = $(element).find('.cart-product__detail');                            
                                $cartProductDetail.click(function (e) {
                                    console.log($cartProductDetail);
                                    $containerCartDetail.css('display', 'block');
                                })
    
                                $(element).find('.cart-product__delete-form').on("submit", function(e) {
                                    e.preventDefault();
                                    $.ajax({
                                        type: 'POST',
                                        // url: ,
                                        data: {
                                            'action': 'delete_cart_product',
                                            'product_id': element.attr('data-product-id'),
                                            'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
                                        },
                                        success: function(response) {
                                            const productDelete = JSON.parse(response.product_delete)[0];
                                            const productDeleteDataField = productDelete.fields;
                                            var totalPriceETH = `${parseFloat(response.total_price).toFixed(3)} ETH`;
                                            var totalPriceDollar = `$${parseFloat(response.total_price * 1789).toFixed(2)}`;
                                            var itemAmount = `${response.number_cart_products} ${response.number_cart_products == 1 ? 'item' : 'items'}`;
    
                                            $('.cart__price-value-eth').text(`${totalPriceETH}`);
                                            $('.cart__price-value-dollar').text(`${totalPriceDollar}`);
                                            if(response.state == 'delete_cart_product') {
                                                $('.cart__number').text(`${itemAmount}`);
                                                if(response.number_cart_products != 0) {
                                                    $(`.cart-product__list`).find(element).remove();
                                                    $('.cart-add__number-pro').text(`${response.number_cart_products}`);
                                                }
                                                else {
                                                    $(`.cart-product__list`).html(`
                                                        <div class="cart__hint flex_aic_jcc">
                                                            <div class="cart-hint__inner flex_fdc_aic">
                                                                <p class="cart-hint__announce">Add items to get started</p>
                                                                <a href="{% url 'artworks1' %}" class="button cart-hint__redirect">Explore now</a>
                                                            </div>
                                                        </div>`);
                                                    $('.cart__amount').html('');
                                                    $('.cart__footer').html('');
                                                    $('.cart-add-block .cart-add__number-pro').remove();
                                                }
                                            }
                                            $(`.${productDeleteDataField.name}.profile-product__item .cart-add-feature`).html(`
                                                <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                                </svg>
                                            `);
                                        },
                                        error: function(jqXHR, textStatus, errorTh) {
                                            console.log(jqXHR, textStatus, errorTh);
                                        }
                                    })
                                })
                            })
                            // collection = $('.profile__collection').html();
                        }
                    });
                });
            });
        }

        addCartFeature();


        $('.profile__search-bar').on('submit', function(e) {
            e.preventDefault();
            // $('.profile__search-text').val('');
        })
    
        
        const sendSearchQuery = (searchQuery) => {
            $.ajax({
                type: 'POST',
                // url: ,
                data: {
                    'action': 'search_product',
                    'csrfmiddlewaretoken': $('profile__search-bar').find('input[name=csrfmiddlewaretoken]').val(),
                    'search_data': searchQuery,
                },
                success: function(response) {
                    console.log($(collectionList[0]));
                    if (!response.search_query) {
                        $('.profile__collection').html(collection);
                        for(let collection of collectionList) {
                            // console.log($(collection[0]))
                            $(collection[0]).html(collection[1]);
                        }
                        $('.classify__item-feature-1:nth-child(2)').html(`
                            Trending
                            <svg xmlns="http://www.w3.org/2000/svg" width="27" height="27" viewBox="0 0 27 27" fill="none">
                                <path d="M17.2969 12.2344L13.5 16.4531L9.70312 12.2344" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        `);
                    } else {
                        console.log(response.state, response.search_query);
                        if(response.state == 'not_found') {
                            $('.profile__collection').html(`
                                <div class="profile__annouce flex_aic_jcc">
                                    <p class="profile__annouce-text">No items to display</p>
                                </div>
                            `);
                        } else {
                            const productsFound = JSON.parse(response.products_found);
                            const additionalFields = JSON.parse(response.additional_fields);

                            const user = JSON.parse(response.user)[0];
                            const userId = user.id;
                            const userField = user.fields;

                            $('.profile__collection').html(`
                                <ul class="profile-product__list" data-num-product=${response.num_products} data-user="${user}" data-user-id="${userId}" data-user-name="${userField.name}}"></ul>
                            `);
                            let found_element = ''
                            let index = 0;
                            let ownedElement = `
                                <div class="profile__announce flex_aic_jcc">
                                    <p class="profile__announce-text">Owned</p>
                                </div>
                            `
                            let inCartElement = `
                                <form method="POST" action="" data-user="${userField.user}" data-user-id="${userId}" data-user-name="${userField.name}" class="cart-add-feature-form">
                                    {% csrf_token %}
                                    <div class="buy-button">Buy now</div>
                                    <button type="submit" class="cart-add-feature flex_aic_jcc">
                                        <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                        </svg>
                                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 640 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M5.1 9.2C13.3-1.2 28.4-3.1 38.8 5.1l592 464c10.4 8.2 12.3 23.3 4.1 33.7s-23.3 12.3-33.7 4.1L9.2 42.9C-1.2 34.7-3.1 19.6 5.1 9.2z"/></svg>
                                    </button> 
                                </form>
                            `;
                            
                            let notInCartElement = `
                                <form method="POST" action="" data-user="${userField.user}" data-user-id="${userId}" data-user-name="${userField.name}" class="cart-add-feature-form">
                                    {% csrf_token %}
                                    <div class="buy-button">Buy now</div>
                                    <button type="submit" class="cart-add-feature flex_aic_jcc"> 
                                        <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                        </svg>
                                    </button> 
                                </form>
                            `;

                            for(let product of productsFound) {
                                const productId = product.pk;
                                const productField = product.fields;

                                const topic = additionalFields[index].topic_name;
                                // console.log(topic);
                                
                                const checkUserOwn = additionalFields[index].owned;
                                // console.log('check user own', checkUserOwn);
                                
                                const checkInCart = additionalFields[index].in_cart;
                                // console.log(checkInCart, typeof checkInCart);
                                
                                // console.log(product);
                                found_element += `
                                    <li data-product-id="${productId}" class="${productField.name} profile-product__item">
                                        <a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/collection1/" + productId}" class="profile-product__link">
                                            <div>
                                                <img src="${productField.image}" alt="" class="profile-product__img">
                                            </div>
                                            <div class="profile-product__info">
                                                <h2 class="profile-product__name limit-line">${productField.name}</h2>
                                                <p class="profile-product__topic limit-line">${topic}</p>
                                            </div>
                                            ${(checkUserOwn) ? ownedElement : (checkInCart) ? inCartElement : notInCartElement}
                                        </a>
                                    </li>
                                `;
                                index++;
                            }
                            $('.profile-product__list').append(found_element);
                        }
                    }
                    addCartFeature();
                },
                error: function(jqXHR, textStatus, errorTh) {
                    console.log(jqXHR, textStatus, errorTh);
                }
                
            })
        }
        $('.profile__search-text').on('keyup', function(e) {
            sendSearchQuery(e.target.value);
            
        })

        $('.classify__child-form-1').each((index, element) => {
            $(element).on('submit', (e) => {
                e.preventDefault();
                const $filterButton = $(element).find('.classify__child-button-1');
                $.ajax({
                    type: 'POST',
                    // url:, 
                    data: {
                        'action': 'filter_product',
                        'csrfmiddlewartoken': $(element).find('input[name=csrfmiddlewaretoken]').val(),
                        'filter_data': $filterButton.attr('filter-data'),
                        'search_query': $('.profile__search-text').val(),
                    },
                    success: function(response) {
                        $('.classify__item-feature-1:nth-child(2)').html(`
                            ${response.type_filter}
                            <svg xmlns="http://www.w3.org/2000/svg" width="27" height="27" viewBox="0 0 27 27" fill="none">
                            <path d="M17.2969 12.2344L13.5 16.4531L9.70312 12.2344" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        `);
                        if(response.state == 'not_found') {
                            $('.profile__collection').html(`
                                <div class="profile__annouce flex_aic_jcc">
                                    <p class="profile__annouce-text">No items to display</p>
                                </div>
                            `);
                        } else {
                            const productsFilter = JSON.parse(response.products_filter);
                            const additionalFields = JSON.parse(response.additional_fields);

                            const user = JSON.parse(response.user)[0];
                            const userId = user.id;
                            const userField = user.fields;
                            
                            console.log(user);
                            $('.profile__collection').html(`
                                <ul class="profile-product__list" data-num-product=${response.num_products} data-user="${user}" data-user-id="${userId}" data-user-name="${userField.name}}"></ul>
                            `);
                            let found_element = ''
                            let index = 0;
                            let ownedElement = `
                                <div class="profile__announce flex_aic_jcc">
                                    <p class="profile__announce-text">Owned</p>
                                </div>
                            `
                            let inCartElement = `
                                <form method="POST" action="" data-user="${userField.user}" data-user-id="${userId}" data-user-name="${userField.name}" class="cart-add-feature-form">
                                    {% csrf_token %}
                                    <div class="buy-button">Buy now</div>
                                    <button type="submit" class="cart-add-feature flex_aic_jcc">
                                        <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                        </svg>
                                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 640 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M5.1 9.2C13.3-1.2 28.4-3.1 38.8 5.1l592 464c10.4 8.2 12.3 23.3 4.1 33.7s-23.3 12.3-33.7 4.1L9.2 42.9C-1.2 34.7-3.1 19.6 5.1 9.2z"/></svg>
                                    </button> 
                                </form>
                            `;
                            
                            let notInCartElement = `
                                <form method="POST" action="" data-user="${userField.user}" data-user-id="${userId}" data-user-name="${userField.name}" class="cart-add-feature-form">
                                    {% csrf_token %}
                                    <div class="buy-button">Buy now</div>
                                    <button type="submit" class="cart-add-feature flex_aic_jcc"> 
                                        <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
                                        </svg>
                                    </button> 
                                </form>
                            `;

                            for(let product of productsFilter) {
                                const productId = product.pk;
                                const productField = product.fields;

                                const topic = additionalFields[index].topic_name;
                                // console.log(topic);
                                
                                const checkUserOwn = additionalFields[index].owned;
                                // console.log('check user own', checkUserOwn);
                                
                                const checkInCart = additionalFields[index].in_cart;
                                // console.log(checkInCart, typeof checkInCart);
                                
                                // console.log(product);
                                found_element += `
                                    <li data-product-id="${productId}" class="${productField.name} profile-product__item">
                                        <a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/collection1/" + productId}" class="profile-product__link">
                                            <div>
                                                <img src="${productField.image}" alt="" class="profile-product__img">
                                            </div>
                                            <div class="profile-product__info">
                                                <h2 class="profile-product__name limit-line">${productField.name}</h2>
                                                <p class="profile-product__topic limit-line">${topic}</p>
                                            </div>
                                            ${(checkUserOwn) ? ownedElement : (checkInCart) ? inCartElement : notInCartElement}
                                        </a>
                                    </li>
                                `;
                                index++;
                            }
                            $('.profile-product__list').append(found_element);
                        }
                        addCartFeature();
                    },    
                    error: function(jqXHR, textStatus, errorTh) {
                        console.log(jqXHR, textStatus, errorTh);
                    }
                })
            })
        })

        // const profileProductList = document.querySelector('.profile-product__list');
        // const profileProductItem = document.querySelectorAll('.profile-product__item');
        
        // const cartNumber_ = document.querySelector('.cart__number');
    
        // const cartAmount_ = document.querySelector('.cart__amount');
        // const cartFooter_ = document.querySelector('.cart__footer');
        // profileProductItem.forEach(element => {
        //     if(element.querySelector('.cart-add-feature-form')) {
        //         const productId = element.getAttribute('data-product-id');
                
        //         const cartAddFeatureForm = element.querySelector('.cart-add-feature-form');
        //         const cartAddFeature = cartAddFeatureForm.querySelector('.cart-add-feature');
                
        //         const requestUserData = cartAddFeatureForm.getAttribute('data-user');
        //         const requestUserDataId = cartAddFeatureForm.getAttribute('data-user-id');
        //         const requestUserDataName = cartAddFeatureForm.getAttribute('data-user-name'); 
        //         const requestUserCart = document.querySelector(`.cart-product__list`);
                
        //         const cartPriceValueEth = document.querySelector('.cart__price-value-eth');
        //         const cartPriceValueDollar = document.querySelector('.cart__price-value-dollar');
        //         if(cartAddFeatureForm) {
        //             cartAddFeatureForm.onsubmit = (e) => {
        //                 // console.log(cartNumber_);
        //                 e.preventDefault();
        //                 $.ajax({
        //                     type: "POST",
        //                     // url: '',
        //                     data: {
        //                         'action': 'cart_add',
        //                         'product_id': productId,
        //                         'csrfmiddlewaretoken': element.children[0].value,
        //                     },
        //                     success: function(response) {
        //                         const product = JSON.parse(response['product']);
            
        //                         const productData = product[0];
        //                         const productAuthorData = product[1];
        //                         const productTopicData = product[2];
            
        //                         const productDataId = productData.pk;
        //                         const productDataField = productData.fields;
            
        //                         const productAuthorDataId = productAuthorData.pk;
        //                         const productAuthorDataField = productAuthorData.fields;
                                
        //                         const productTopicDataField = productTopicData.fields;
        //                         const itemAmount = response['number_cart_products'] == 1 ? 'item' : 'items';
        //                         console.log(response['number_cart_products']);
                                
        //                         const totalPrice = response['total_price'];
        //                         if(cartPriceValueEth) {
        //                             cartPriceValueEth.textContent = `${parseFloat(totalPrice).toFixed(3)} ETH`;
        //                             cartPriceValueDollar.textContent = `$${parseFloat(totalPrice * 1789).toFixed(2)}`;   
        //                         }
        //                         if(response['state'] == 'cart_add') {
        //                             let new_cart_product = `
        //                                 <li data-product-id="${productDataId}" class="${productDataField.name} cart-product__item flex_aic_jcsb">
        //                                     <div class="cart__product--wrap flex_aic_jcsb">
        //                                         <a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/collection1/" +productDataId}" class="cart-product__img--wrap">
        //                                             <img src="${productDataField.image}" alt="" class="cart-product__img">
        //                                         </a>
        //                                         <div class="cart-product__info">
        //                                             <p class=" cart-product__name"><a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/collection1/" +productDataId}" class="cart-text">${productDataField.name}</a></p>
        //                                             <p class="cart-text-2 cart-product__topic">${productTopicDataField.name}</p>
        //                                             <p class="cart-text-2 cart-product__price">${parseFloat(productDataField.price).toFixed(3)} ETH</p>
        //                                             <button class="cart-product__detail">Show Details</button>
        //                                             <div class="container-cart-detail">
        //                                                 <div class="cart-detail">
        //                                                     <div class="cart-detail__head flex_aic_jcsb">
        //                                                         <p class="cart-text cart-detail__heading">This is an unreviewed collection</p>
        //                                                         <button class="cart-detail__close close-button">
        //                                                             <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"/></svg>
        //                                                         </button>
        //                                                     </div>
        //                                                     <div class="cart-detail__info">
        //                                                         <div class="cart-detail__table--wrap">
        //                                                             <table class="cart-detail__table">
        //                                                                 <tr>
        //                                                                     <td class="cart-text-2">Collection name</td>
        //                                                                     <td class=""><a href=//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/collection1/" +productDataId}" class="cart-text-2">${productDataField.name}</a></td>
        //                                                                 </tr>
        //                                                                 <tr>
        //                                                                     <td class="cart-text-2">Creator</td>
        //                                                                     <td class="cart-text-2">
        //                                                                         <a href="${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/profile/" + requestUserDataId}" class="cart-detail__author">${productAuthorDataField.name}</a>
        //                                                                         <p class="">Joined in ${convertDateTimeString(productAuthorDataField.date_joined)}</p>
        //                                                                     </td>
        //                                                                 </tr>
        //                                                                 <tr>
        //                                                                     <td class="cart-text-2">Total sales</td>
        //                                                                     <td class="cart-text-2">0 ETH</td>
        //                                                                 </tr>
        //                                                                 <tr>
        //                                                                     <td class="cart-text-2">Total volume</td>
        //                                                                     <td class="cart-text-2">
        //                                                                         <p class="">0 ETH</p>
        //                                                                         <p class="">$0</p>
        //                                                                     </td>
        //                                                                 </tr>
        //                                                                 <tr>
        //                                                                     <td class="cart-text-2">Total items</td>
        //                                                                     <td class="cart-text-2">${productDataField.quantity}</td>
        //                                                                 </tr>
        //                                                                 <tr>
        //                                                                     <td class="cart-text-2">Created Date</td>
        //                                                                     <td class="cart-text-2">${convertDateTimeString(productDataField.created_at)}</td>
        //                                                                 </tr>
        //                                                             </table>
        //                                                         </div>
        //                                                     </div>
        //                                                 </div>
        //                                             </div>
        //                                         </div>
        //                                     </div>
        //                                     <form action="" class="{{product.name}} cart-product__delete-form">
        //                                         {% csrf_token %}
        //                                         <input type="hidden" name="action" value="delete_cart_product">
        //                                         <button class="cart-product__delete">
        //                                             <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M164.2 39.5L148.9 64H299.1L283.8 39.5c-2.9-4.7-8.1-7.5-13.6-7.5H177.7c-5.5 0-10.6 2.8-13.6 7.5zM311 22.6L336.9 64H384h32 16c8.8 0 16 7.2 16 16s-7.2 16-16 16H416V432c0 44.2-35.8 80-80 80H112c-44.2 0-80-35.8-80-80V96H16C7.2 96 0 88.8 0 80s7.2-16 16-16H32 64h47.1L137 22.6C145.8 8.5 161.2 0 177.7 0h92.5c16.6 0 31.9 8.5 40.7 22.6zM64 96V432c0 26.5 21.5 48 48 48H336c26.5 0 48-21.5 48-48V96H64zm80 80V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V176c0-8.8 7.2-16 16-16s16 7.2 16 16zm96 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V176c0-8.8 7.2-16 16-16s16 7.2 16 16zm96 0V400c0 8.8-7.2 16-16 16s-16-7.2-16-16V176c0-8.8 7.2-16 16-16s16 7.2 16 16z"/></svg>
        //                                         </button>
        //                                     </form>
        //                                 </li>
        //                             `
        //                             if(cartAddFeature) {
        //                                 cartAddFeature.innerHTML = `
        //                                     <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
        //                                     </svg>
        //                                     <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 640 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M5.1 9.2C13.3-1.2 28.4-3.1 38.8 5.1l592 464c10.4 8.2 12.3 23.3 4.1 33.7s-23.3 12.3-33.7 4.1L9.2 42.9C-1.2 34.7-3.1 19.6 5.1 9.2z"/></svg>    
        //                                 `
        //                             }
                                    
        //                             if(response['number_cart_products'] == 1) {
        //                                 requestUserCart.innerHTML = ''
        //                                 requestUserCart.insertAdjacentHTML('beforeend', new_cart_product);
        //                                 cartAmount_.innerHTML = `
        //                                     <p class="cart-text cart__number">${response['number_cart_products']} ${itemAmount}</p>
        //                                     <form method="POST" action="" class="cart__clear-form">
        //                                         {% csrf_token %}
        //                                         <input type="hidden" name="action" value="clear_cart_product">
        //                                         <button type="submit" class="cart-text cart__clear">Clear all</button>
        //                                     </form>
        //                                     `
                                        
            
        //                                 const cartClearForm = document.querySelector('.cart__clear-form');
        //                                 cartClearForm.onsubmit = (e) => {
        //                                     e.preventDefault();
        //                                     $.ajax({
        //                                         type: 'POST',
        //                                         url: window.location.href,
        //                                         data: {
        //                                             'action': 'clear_cart_product',
        //                                             'csrfmiddlewaretoken': cartClearForm.children[0].value,
        //                                         },
        //                                         success: function(response) {
        //                                             console.log(response['state']);
        //                                             if(response['state'] == 'clear_cart_product') {
        //                                                 cartProductList.innerHTML = `
        //                                                     <div class="cart__hint flex_aic_jcc">
        //                                                         <div class="cart-hint__inner flex_fdc_aic">
        //                                                             <p class="cart-hint__announce">Add items to get started</p>
        //                                                             <a href="{% url 'artworks1' %}" class="button cart-hint__redirect">Explore now</a>
        //                                                         </div>
        //                                                     </div>
        //                                                 `
        //                                                 cartAmount_.innerHTML = ``;
        //                                                 cartFooter_.innerHTML = ``;
        //                                             }
        //                                         },
        //                                         error: function(jqXHR, textStatus, errorTh) {
        //                                             console.log(jqXHR, textStatus, errorTh);
        //                                         }
        //                                     })
        //                                 }
                                            
                                        
                                        
        //                                 if(cartFooter_) {
        //                                     cartFooter_.innerHTML = `
        //                                         <div class="cart__price flex_aic_jcsb">
        //                                             <p class="cart-text cart__price-key">Total price</p>
        //                                             <div class="cart__price-value">
        //                                                 <p class="cart-text cart__price-value-eth">${parseFloat(totalPrice).toFixed(3)} ETH</p>
        //                                                 <p class="cart-text-2 cart__price-value-dollar">$${parseFloat(totalPrice * 1789).toFixed(2)}</p>
        //                                             </div>
        //                                         </div>
        //                                         <form action="" class="cart__buy" method="POST">
        //                                             {% csrf_token %}
        //                                             <input type="hidden" name="action" value="purchase_nft">
        //                                             <button type="submit" class="cart__buy-button">Complete purchase</button>
        //                                         </form>
        //                                     `
        //                                 }
        //                             }
        //                             if(response['number_cart_products'] > 1) {
        //                                 document.querySelector(`.cart-product__list`).insertAdjacentHTML('beforeend', new_cart_product);
        //                                 document.querySelector('.cart__number').innerHTML = `${response['number_cart_products']} ${itemAmount}`;
        //                                 document.querySelector(`.cart-product__list`).onsubmit = (e) => {
        //                                     $.ajax({
        //                                         type: "POST",
        //                                         // url: '',
        //                                         data: {
        //                                             'action': 'cart_add',
        //                                             'product_id': productId,
        //                                             'csrfmiddlewaretoken': element.children[0].value,
        //                                         },
        //                                         success: function(response) {
        //                                             if(response['state'] == 'cart_add') {
        //                                                 document.querySelector('.cart-add-feature').innerHTML = `
        //                                                     <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
        //                                                     </svg>
        //                                                 `
        //                                             } else { 
        //                                                 document.querySelector('.cart-add-feature').innerHTML = `
        //                                                     <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
        //                                                     </svg>
        //                                                     <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 640 512" fill="#fff"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M5.1 9.2C13.3-1.2 28.4-3.1 38.8 5.1l592 464c10.4 8.2 12.3 23.3 4.1 33.7s-23.3 12.3-33.7 4.1L9.2 42.9C-1.2 34.7-3.1 19.6 5.1 9.2z"/></svg>    
        //                                                 `
        //                                             }
        //                                         }
        //                                     })
        //                                 }   
        //                                 cartPriceValueEth.textContent = `${parseFloat(totalPrice).toFixed(3)} ETH`
        //                                 cartPriceValueDollar.textContent = `$${parseFloat(totalPrice * 1789).toFixed(2)}`
        //                             } 
        //                         } else {
                                    
        //                             if(response['number_cart_products'] == 0) {
        //                                 // cartAddFeature.innerHTML = `
        //                                 cartAddFeature.innerHTML = `
        //                                             <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
        //                                             </svg>`
        //                                 // cartProductList.innerHTML = `
        //                                 document.querySelector(`.cart-product__list`).innerHTML = `
        //                                     <div class="cart__hint flex_aic_jcc">
        //                                         <div class="cart-hint__inner flex_fdc_aic">
        //                                             <p class="cart-hint__announce">Add items to get started</p>
        //                                             <a href="{% url 'artworks1' %}" class="button cart-hint__redirect">Explore now</a>
        //                                         </div>
        //                                     </div>
        //                                 `
        //                                 document.querySelector('.cart__amount').innerHTML = ``;
        //                                 document.querySelector('.cart__footer').innerHTML = ``;
        //                                 // cartAmount.innerHTML = ``;
        //                                 // cartFooter_.innerHTML = ``;
        //                             }
        //                             else {
        //                                 cartNumber_.innerHTML = `${response['number_cart_products']} ${itemAmount}`
        //                                 cartAddFeature.innerHTML = `
        //                                     <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
        //                                     </svg>
        //                                 `
        //                                 requestUserCart.removeChild(requestUserCart.querySelector(`.${productDataField.name}.cart-product__item`));
        //                             }
        //                         }
        //                         const cartClose = document.querySelector('.cart__close');
        //                         const containerCart = document.querySelector('.container-cart');
        //                         const cart = document.querySelector('.cart');
        //                         cartClose.onclick = (e) => {
        //                             containerCart.style.display = 'none';
        //                         }
            
        //                         containerCart.onclick = (e) => {
        //                             if(e.target !== cart) {
        //                                 containerCart.style.display = 'none';
        //                             }
        //                         }
                                
        //                         cart.onclick = (e) => {
        //                             e.stopPropagation();
        //                         }
            
        //                         console.log(typeof productDataField.created_at);
        //                         const containerCartDetail = document.querySelectorAll('.container-cart-detail');
        //                         containerCartDetail.forEach(element => {
        //                             const cartDetailClose = element.querySelector('.cart-detail__close');
        //                             const cartDetail = element.querySelector('.cart-detail');
        //                             cartDetailClose.onclick = (e) => {
        //                                 element.style.display = 'none';
        //                             }
                                
        //                             element.onclick = (e) => {
        //                                 if(e.target !== cartDetail) {
        //                                     element.style.display = 'none';
        //                                 }
        //                             }
                                    
        //                             cartDetail.onclick = (e) => {
        //                                 e.stopPropagation();
        //                             }
        //                         })
            
        //                         const cartProductDetail = document.querySelectorAll('.cart-product__detail');
        //                         cartProductDetail.forEach(element => {
        //                             element.onclick = (e) => {
        //                                 element.nextElementSibling.style.display = 'block';
        //                             }
        //                         });
            
        //                         const cartNumber = document.querySelector('.cart__number'); 
        //                         const cartProductList = document.querySelector(`.cart-product__list`);
        //                         const cartAmount =  document.querySelector('.cart__amount');
        //                         // const cartFooter_ = document.querySelector('.cart__footer');
        //                         const cartClearForm = document.querySelector('.cart__clear-form');
            
        //                         const newCartProductItem = cartProductList.lastElementChild;
        //                         const cartProductDeleteForm = newCartProductItem.querySelector('.cart-product__delete-form');
        //                         if(cartProductDeleteForm) {
        //                             cartProductDeleteForm.onsubmit = (e) => {
        //                                 e.preventDefault();
        //                                 $.ajax({
        //                                     type: 'POST',
        //                                     url: window.location.href,
        //                                     data: {
        //                                         'action': 'delete_cart_product',
        //                                         'product_id': newCartProductItem.getAttribute('data-product-id'),
        //                                         'csrfmiddlewaretoken': cartProductDeleteForm.children[0].value,
        //                                     },
        //                                     success: function(response) {
        //                                         console.log(response['number_cart_products']);
        //                                         cartPriceValueEth.textContent = `${parseFloat(response['total_price']).toFixed(3)} ETH`
        //                                         cartPriceValueDollar.textContent = `$${parseFloat(response['total_price'] * 1789).toFixed(2)}`
        //                                         if(response['state'] == 'delete_cart_product') {
        //                                             cartNumber.textContent = `${response['number_cart_products']} ${response['number_cart_products'] == 1 ? 'item' : 'items'}`;
        //                                             cartAddFeature.innerHTML = `
        //                                                 <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
        //                                                 </svg>`
        //                                             if(response['number_cart_products'] != 0) {
        //                                                 cartProductList.removeChild(newCartProductItem);
        //                                             }
        //                                             else {
        //                                                 cartProductList.innerHTML = `
        //                                                     <div class="cart__hint flex_aic_jcc">
        //                                                         <div class="cart-hint__inner flex_fdc_aic">
        //                                                             <p class="cart-hint__announce">Add items to get started</p>
        //                                                             <a href="{% url 'artworks1' %}" class="button cart-hint__redirect">Explore now</a>
        //                                                         </div>
        //                                                     </div>`;
        //                                                 cartAmount.innerHTML = ``;
        //                                                 cartFooter_.innerHTML = ``;
        //                                             }
        //                                         }
        //                                     },
        //                                     error: function(jqXHR, textStatus, errorTh) {
        //                                         console.log(jqXHR, textStatus, errorTh);
        //                                     }
        //                                 })
        //                             }
        //                         }
        //                         if(cartClearForm) {
        //                             cartClearForm.onsubmit = (e) => {
        //                                 e.preventDefault();
        //                                 $.ajax({
        //                                     type: 'POST',
        //                                     url: window.location.href,
        //                                     data: {
        //                                         'action': 'clear_cart_product',
        //                                         'csrfmiddlewaretoken': cartClearForm.children[0].value,
        //                                     },
        //                                     success: function(response) {
        //                                         console.log(response['state']);
        //                                         if(response['state'] == 'clear_cart_product') {
        //                                             cartAddFeature.innerHTML = `
        //                                                 <svg class="product-detail__svg" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512" style="fill:#ffffff"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/>
        //                                                 </svg>`
        //                                             cartProductList.innerHTML = `
        //                                                 <div class="cart__hint flex_aic_jcc">
        //                                                     <div class="cart-hint__inner flex_fdc_aic">
        //                                                         <p class="cart-hint__announce">Add items to get started</p>
        //                                                         <a href="{% url 'artworks1' %}" class="button cart-hint__redirect">Explore now</a>
        //                                                     </div>
        //                                                 </div>
        //                                             `
        //                                             cartAmount.innerHTML = ``;
        //                                             cartFooter_.innerHTML = ``;
        //                                         }
        //                                     },
        //                                     error: function(jqXHR, textStatus, errorTh) {
        //                                         console.log(jqXHR, textStatus, errorTh);
        //                                     }
        //                                 })
        //                             }
        //                         }
                                
            
        //                     },
        //                     error: function(xhr, status, status) {
        //                         console.log(xhr, status, status);
        //                     }
        //                 });
        //             }     
        //         } else {
        //             console.log("INVALID");
        //         }
        //     }
        // })










        

        $('.profile.follow-button-form').submit((e) => {
            e.preventDefault();
            const user = '{{user|escapejs}}';
            const user_id = '{{user.id|escapejs}}';
            $.ajax({
                type: "POST",
                // url: `/profile/${user_id}`,
                data: {
                  'action': 'follow', 
                  'user_follow': user,
                  'user_follow_id': user_id,
                  'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
                },
                success: function(response) {
                    let profileUserFollower = JSON.parse(response['profile_user_follower'])
                    let userFollowField = profileUserFollower[0].fields
                    let userFollowId = profileUserFollower[0].pk
                    $('.profile__follower-value').text(`${response['number_follower']}`);
                    if(response['state'] == 'unfollow') {
                        $('.profile.follow-button-form').html(``);
                        $('.profile.follow-button-form').html(`
                        <input type="hidden" name="action" value="follow">
                        {% csrf_token %}
                        <button type="submit" class="follow-button flex_aic_jcc">
                         <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8" fill="none">
                             <path d="M3.2549 0V3.33333H0V4.64762H3.2549V8H4.72549V4.64762H8V3.33333H4.72549V0H3.2549Z" fill="#000"/>
                         </svg>
                         Follow
                    </button>`);
                        $('.follower.user-behavior__list').children().last().remove();
                    }
                    else {
                        $('.profile.follow-button-form').html(``);
                        $('.profile.follow-button-form').html(`
                        <input type="hidden" name="action" value="follow">
                        {% csrf_token %}
                        <button type="submit" class="unfollow-button flex_aic_jcc">
                            <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="#000"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"/></svg>
                         Unfollow
                    </button>`);

                    let new_user_follow = `
                    <li class="user-behavior__item flex_aic_jcc">
                        <div class="user-behavior__info">
                            <a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/profile/" + userFollowId}/" class="avatar-wrap user-behavior-person__avt-link">
                                <img src="${userFollowField.avatar}" alt="" class="user-behavior-person__avt avatar">
                            </a>
                            <div class="user-behavior-person flex_aic_jcc">
                                <div class="user-behavior-person__text-block flex_fdc_aif">
                                    <a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/profile/" + userFollowId}/" class="user-behavior-person__name">${userFollowField.name}</a>
                                    <a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/profile/" + userFollowId}/" class="user-behavior-person__id">${userFollowId.slice(0,6) + '...' +userFollowId.slice(-4)}</a>
                                </div>
                            </div>     
                        </div>
                    </li>`
                    $('.follower.user-behavior__list').append(new_user_follow);
                    }
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.log('error', jqXHR, textStatus, errorThrown);
                }
            });
        });
        // let newUserFolowList = []
        // $('.get_behavior_of_user').each((index, element__) => {
        //     let selectedForm = '.' + element__.textContent + '.follow-button-form';
        //     $(selectedForm).each((index, element) => {
        //         element.onsubmit = (e) => {
        //             e.preventDefault();
        //             $.ajax({
        //                 type: "POST",
        //                 // url: `/profile/${user_id}`,
        //                 data: {
        //                     'action': 'list_follow',
        //                     'user_follow_id': element.classList[0],
        //                     'csrfmiddlewaretoken': element.childNodes[1].value, 
        //                 },
        //                 success: function(response) {
        //                     let profileUserFollower = JSON.parse(response['profile_user_follower']);
        //                     let userPosition = JSON.parse(response['user_position']);
        //                     let requestUserId = '{{request.user.id|escapejs}}';
        //                     let userFollowField = profileUserFollower[0].fields;
        //                     let userFollowId = profileUserFollower[0].pk;
        //                     console.log(response['state']);
        //                     console.log(response['number_follow']);
        //                     console.log(document.querySelector('.profile__followee-value.user_authenticated .profile__follow-value'));
        //                     $('.profile__followee-value.user_authenticated .profile__follow-value').text(`${response['number_follow']}`);
        //                     if(response['state'] == 'unfollow') {
        //                         element.innerHTML = `
        //                             <input type="hidden" name="action" value="list_follow">
        //                             {% csrf_token %}
        //                             <button type="submit" class="follow-button flex_aic_jcc">
        //                             <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8" fill="none">
        //                                 <path d="M3.2549 0V3.33333H0V4.64762H3.2549V8H4.72549V4.64762H8V3.33333H4.72549V0H3.2549Z" fill="#000"/>
        //                             </svg>
        //                             Follow
        //                         </button>`;
        //                     console.log(`.user-behavior__item.${userFollowId}`);    
        //                     // if(requestUserId == userPosition[0].pk) {
        //                     //     console.log($('.follow.user-behavior__list').find(`.${userFollowId}`));
        //                     //     $('.follow.user-behavior__list').find(`.${userFollowId}`).remove();
        //                     // }
        //                     }
        //                     else {
        //                     element.innerHTML = `
        //                         <input type="hidden" name="action" value="list_follow">
        //                         {% csrf_token %}
        //                         <button type="submit" class="unfollow-button flex_aic_jcc">
        //                             <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="#000"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"/></svg>
        //                         Unfollow
        //                     </button>`;
        //                     if (requestUserId == userPosition[0].pk) {
        //                         let newUserFollow = `
        //                         <li class="user-behavior__item ${userFollowId} flex_aic_jcc">
        //                             <div class="user-behavior__info">
        //                                 <a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/profile/" + userFollowId}/" class="avatar-wrap user-behavior-person__avt-link">
        //                                     <img src="${userFollowField.avatar}" alt="" class="user-behavior-person__avt avatar">
        //                                 </a>
        //                                 <div class="user-behavior-person flex_aic_jcc">
        //                                     <div class="user-behavior-person__text-block flex_fdc_aif">
        //                                         <a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/profile/" + userFollowId}/" class="user-behavior-person__name">${userFollowField.name}</a>
        //                                         <a href="//${window.location.hostname + (window.location.port ? ":" : "") + window.location.port + "/profile/" + userFollowId}/" class="user-behavior-person__id">${userFollowId.slice(0,6) + '...' +userFollowId.slice(-4)}</a>
        //                                     </div>
        //                                 </div>     
        //                             </div>
        //                             <form method="POST" action="" class="${userFollowId} ${element__.textContent} follow-button-form">
        //                             {% csrf_token %}
        //                             <input type="hidden" name="action" value="list_follow">
        //                             <button type="submit" class="follow-button unfollow-button flex_aic_jcc">
        //                                     <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="#000"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"/></svg>
        //                                     Unfollow
        //                                 </button>
        //                             </form>
        //                         </li>
        //                         `
        //                         $('.follow.user-behavior__list').append(newUserFollow);
                                
        //                         newUserFolowList.push($('.follow.user-behavior__list').children().last().children()[1]);
        //                     }
        //                     }
        //                     newUserFolowList.forEach((element) => {
        //                         console.log(element);
        //                         element.onsubmit = (e) => {
        //                             e.preventDefault();
        //                             $.ajax({
        //                                 type: "POST",
        //                                 // url: `/profile/${user_id}`,
        //                                 data: {
        //                                 'action': 'list_follow',
        //                                 'user_follow_id': element.classList[0],
        //                                 'csrfmiddlewaretoken': element.childNodes[1].value, 
        //                                 },
                                        
        //                                 success: function(response) {
        //                                     $('.profile__followee-value.user_authenticated .profile__follow-value').text(`${response['number_follow']}`);
        //                                     let stateOfFollowButton = '';
        //                                     if(response['state'] == 'unfollow') {
        //                                         stateOfFollowButton = `
        //                                         <input type="hidden" name="action" value="list_follow">
        //                                         {% csrf_token %}
        //                                         <button type="submit" class="follow-button flex_aic_jcc">
        //                                         <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8" fill="none">
        //                                             <path d="M3.2549 0V3.33333H0V4.64762H3.2549V8H4.72549V4.64762H8V3.33333H4.72549V0H3.2549Z" fill="#000"/>
        //                                         </svg>
        //                                         Follow
        //                                     </button>`;
        //                                     }
        //                                     else {
        //                                         stateOfFollowButton = `
        //                                             <input type="hidden" name="action" value="list_follow">
        //                                             {% csrf_token %}
        //                                             <button type="submit" class="unfollow-button flex_aic_jcc">
        //                                                 <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="#000"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"/></svg>
        //                                             Unfollow
        //                                         </button>`;
        //                                         }
        //                                         if(!$(`.followee.container-user-behavior .user-behavior__item .${userFollowField.name}.follow-button-form`)) {
        //                                             console.log("ok");
        //                                             element.innerHTML = stateOfFollowButton
        //                                         } 
        //                                         $(`.follower.container-user-behavior .user-behavior__item .${userFollowField.name}.follow-button-form`).html(stateOfFollowButton);
        //                                 },
        //                                 error: function(jqXHR, textStatus, errorThrown) {
        //                                     console.log('error', jqXHR, textStatus, errorThrown);
        //                                 }
        //                             })
        //                         }
        //                     })
        //                 },
        //                 error: function(jqXHR, textStatus, errorThrown) {
        //                     console.log('error', jqXHR, textStatus, errorThrown);
        //                 }
        //             });
        //         }
        //     });
        // });
        let type_behavior = ['follower', 'followee']
        for(var behavior of type_behavior) {
            let $conatinerUserBehavior = $(`.${behavior}.container-user-behavior`);
            let $userBehaviorItem = $conatinerUserBehavior.find('.user-behavior__item');
            $userBehaviorItem.each((index, element) => {
                let $followButtonForm = $(element).find(`.follow-button-form`);
                $followButtonForm.on('submit', (e) => {
                    e.preventDefault();
                    $.ajax({
                        type: 'POST',
                        // url: ,
                        data: {
                            'action': 'list_follow',
                            'user_follow_id': $followButtonForm.attr('data-id'),
                            'csrfmiddlewaretoken': $(`input[name="csrfmiddlewaretoken`).val(),     
                        },
                        success: function(response) {
                            const userFollow = JSON.parse(response.user_follower)[0];
                            const userFollowId = userFollow.pk;
                            const userFollowField = userFollow.fields;
                            console.log(response.number_follow);
                            $('.profile__followee-value.user_authenticated .profile__follow-value').text(response.number_follow);
                            let stateOfFollowButton = null;
                            if(response.state == 'follow') {
                                stateOfFollowButton = `
                                    {% csrf_token %}
                                    <input type="hidden" name="action" value="list_follow">
                                    <button type="submit" class="follow-button unfollow-button flex_aic_jcc">
                                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512" fill="#000"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"/></svg>
                                        Unfollow
                                    </button>
                                `;
                            } 
                            else {
                                stateOfFollowButton = `
                                    {% csrf_token %}
                                    <input type="hidden" name="action" value="list_follow">
                                    <button type="submit" class="follow-button flex_aic_jcc">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8" fill="none">
                                            <path d="M3.2549 0V3.33333H0V4.64762H3.2549V8H4.72549V4.64762H8V3.33333H4.72549V0H3.2549Z" fill="#000"/>
                                        </svg>
                                        Follow
                                    </button>
                                `;
                            }
                            $followButtonForm.html(stateOfFollowButton);
                            let classQuerry = [
                                `.follower.container-user-behavior .user-behavior__item .${userFollowField.name}.follow-button-form`,
                                `.followee.container-user-behavior .user-behavior__item .${userFollowField.name}.follow-button-form`,
                            ];  
    
                            for(let query of classQuerry) {
                                $(query).html(stateOfFollowButton);   
                            }
                        }
                    })
                })
            })
        }
    });
      
  </script>
{% endblock scripts %}